\PassOptionsToPackage{unicode=true}{hyperref} % options for packages loaded elsewhere
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[ignorenonframetext,]{beamer}
\usepackage{pgfpages}
\setbeamertemplate{caption}[numbered]
\setbeamertemplate{caption label separator}{: }
\setbeamercolor{caption name}{fg=normal text.fg}
\beamertemplatenavigationsymbolsempty
% Prevent slide breaks in the middle of a paragraph:
\widowpenalties 1 10000
\raggedbottom
\setbeamertemplate{part page}{
\centering
\begin{beamercolorbox}[sep=16pt,center]{part title}
  \usebeamerfont{part title}\insertpart\par
\end{beamercolorbox}
}
\setbeamertemplate{section page}{
\centering
\begin{beamercolorbox}[sep=12pt,center]{part title}
  \usebeamerfont{section title}\insertsection\par
\end{beamercolorbox}
}
\setbeamertemplate{subsection page}{
\centering
\begin{beamercolorbox}[sep=8pt,center]{part title}
  \usebeamerfont{subsection title}\insertsubsection\par
\end{beamercolorbox}
}
\AtBeginPart{
  \frame{\partpage}
}
\AtBeginSection{
  \ifbibliography
  \else
    \frame{\sectionpage}
  \fi
}
\AtBeginSubsection{
  \frame{\subsectionpage}
}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provides euro and other symbols
\else % if luatex or xelatex
  \usepackage{unicode-math}
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\usepackage{hyperref}
\hypersetup{
            pdftitle={Session 9: Measurement Practicum Example},
            pdfauthor={Mark Buntaine},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\newif\ifbibliography
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs}
\usepackage{caption}
% These lines are needed to make table captions work with longtable:
\makeatletter
\def\fnum@table{\tablename~\thetable}
\makeatother
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\usepackage{caption}
\captionsetup[figure]{labelformat=empty}

\title{Session 9: Measurement Practicum Example}
\author{Mark Buntaine}
\date{}

\begin{document}
\frame{\titlepage}

\begin{frame}{Manta Trust: Theory of Change}
\protect\hypertarget{manta-trust-theory-of-change}{}

\includegraphics{figures/mobulid_rays.png}

\end{frame}

\begin{frame}{Oceanic Manta Ray}
\protect\hypertarget{oceanic-manta-ray}{}

\includegraphics{figures/manta_oceanic.png}

\end{frame}

\begin{frame}{Conservation Strategies}
\protect\hypertarget{conservation-strategies}{}

\includegraphics{figures/safe_release.png}

\end{frame}

\begin{frame}{Fish Landings in the Phillipines}
\protect\hypertarget{fish-landings-in-the-phillipines}{}

\includegraphics{figures/phillipines_landings.png}

\end{frame}

\begin{frame}{Release}
\protect\hypertarget{release}{}

\includegraphics{figures/manta_release.png}

\end{frame}

\begin{frame}{Measurement Goal \& Measure}
\protect\hypertarget{measurement-goal-measure}{}

\textbf{Goal}: Assess the level of knowledge about safe release
techniques over time.

``In general, how likely will a manta ray survive if it is lifted by a
brailer or piece of canvas and returned to the sea?''

\begin{enumerate}
[a.]
\tightlist
\item
  Very Likely
\item
  Somewhat Likely
\item
  Somewhat Unlikely
\item
  Very Unlikely
\item
  Don't Know
\end{enumerate}

\end{frame}

\begin{frame}{Source \& Rationale \& Unit}
\protect\hypertarget{source-rationale-unit}{}

\emph{Source}: Indepedent survey firm sampling from landing sites at
regular intervals.

\emph{Rationale}: The best way to test knowledge is to measure it
directly. The answer to the question is not obvious and it does not lead
the respondent in a particular direction.

\emph{Unit}: individual survey respondent

\end{frame}

\begin{frame}{Responsibility \& Frequency}
\protect\hypertarget{responsibility-frequency}{}

\emph{Responsibility}: Manta Trust will directly hire survey firm, but
will coordinate with the PFDA to expand the monitoring in the future.

\emph{Frequency}: The intention is to track changes in attitudes over
time. Annual surveys will allow tracking and matches the time period
over which it is feasible for attitudes to change.

\end{frame}

\begin{frame}{Declaring the population}
\protect\hypertarget{declaring-the-population}{}

Using administrative data, I found the approximate number of vessel
visits per month that land tuna.

\begin{longtable}[]{@{}ll@{}}
\toprule
Landing site & Approximate vessels per month\tabularnewline
\midrule
\endhead
General Santos & 700\tabularnewline
Navotas & 670\tabularnewline
Iloilo & 150\tabularnewline
Lucena & 140\tabularnewline
Zamboanga & 40\tabularnewline
Davao & 30\tabularnewline
Sual & 8\tabularnewline
\bottomrule
\end{longtable}

\end{frame}

\begin{frame}{Target Population \& Challenges}
\protect\hypertarget{target-population-challenges}{}

\emph{Target Population}: fishing vessel captains who use purse seine
techniques

\emph{Challenge of drawing a representative sample}: sampling effort
must be done in landing site clusters, but clusters are of unequal size.
It is unclear how often captains return to the same port over the course
of the year.

\emph{Sampling procedure}: Cluster-based sampling at ports with unequal
effort according to potential sample size.

\end{frame}

\begin{frame}[fragile]{DeclareDesign()}
\protect\hypertarget{declaredesign}{}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{228}\NormalTok{)}
\NormalTok{population <-}\StringTok{ }\KeywordTok{declare_population}\NormalTok{(}
  \DataTypeTok{port =} \KeywordTok{add_level}\NormalTok{(}\DataTypeTok{N=}\DecValTok{7}\NormalTok{,}
         \DataTypeTok{baseline=}\KeywordTok{c}\NormalTok{(}\FloatTok{0.6}\NormalTok{,}\FloatTok{0.6}\NormalTok{,}\FloatTok{0.4}\NormalTok{,}\FloatTok{0.4}\NormalTok{,}\FloatTok{0.1}\NormalTok{,}\FloatTok{0.1}\NormalTok{,}\FloatTok{0.1}\NormalTok{)),}
  \DataTypeTok{captain =} \KeywordTok{add_level}\NormalTok{(}\DataTypeTok{N=}\KeywordTok{c}\NormalTok{(}\DecValTok{700}\NormalTok{,}\DecValTok{670}\NormalTok{,}\DecValTok{150}\NormalTok{,}\DecValTok{140}\NormalTok{,}\DecValTok{40}\NormalTok{,}\DecValTok{30}\NormalTok{,}\DecValTok{8}\NormalTok{),}
                      \DataTypeTok{know=}\KeywordTok{draw_binary}\NormalTok{(baseline))}
\NormalTok{)}
\NormalTok{pop <-}\StringTok{ }\KeywordTok{population}\NormalTok{()}
\NormalTok{pop.vector <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{700}\NormalTok{,}\DecValTok{670}\NormalTok{,}\DecValTok{150}\NormalTok{,}\DecValTok{140}\NormalTok{,}\DecValTok{40}\NormalTok{,}\DecValTok{30}\NormalTok{,}\DecValTok{8}\NormalTok{)}

\NormalTok{my_estimand <-}\StringTok{ }\KeywordTok{declare_estimands}\NormalTok{(}\KeywordTok{mean}\NormalTok{(know),}
                                 \DataTypeTok{label =} \StringTok{"Ybar"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile]{DeclareDesign()}
\protect\hypertarget{declaredesign-1}{}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{reporting <-}\StringTok{ }\KeywordTok{declare_assignment}\NormalTok{(}\DataTypeTok{prob=}\FloatTok{0.8}\NormalTok{,}
                  \DataTypeTok{assignment_variable =} \StringTok{"R"}\NormalTok{)}

\NormalTok{sampling <-}\StringTok{ }\KeywordTok{declare_sampling}\NormalTok{(}\DataTypeTok{strata=}\NormalTok{port,}
               \DataTypeTok{strata_n=}\KeywordTok{c}\NormalTok{(}\DecValTok{80}\NormalTok{,}\DecValTok{80}\NormalTok{,}\DecValTok{80}\NormalTok{,}\DecValTok{80}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{8}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile]{DeclareDesign()}
\protect\hypertarget{declaredesign-2}{}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{strata_weighted_mean <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(data)\{}
  \KeywordTok{data.frame}\NormalTok{(  }
  \DataTypeTok{estimator_label =} \StringTok{"strata_w_mean"}\NormalTok{,}
  \DataTypeTok{estimand_label =} \StringTok{"Ybar"}\NormalTok{,}
  \DataTypeTok{n =} \KeywordTok{nrow}\NormalTok{(data),}
  \DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{,}
  
  \DataTypeTok{estimate =}\NormalTok{ data }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(R}\OperatorTok{==}\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{group_by}\NormalTok{(port) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{mean=}\KeywordTok{mean}\NormalTok{(know)) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{prop=}\NormalTok{pop.vector}\OperatorTok{/}\KeywordTok{sum}\NormalTok{(pop.vector)) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{sub.mean=}\NormalTok{mean}\OperatorTok{*}\NormalTok{prop) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{pull}\NormalTok{(sub.mean) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{sum}\NormalTok{())}
\NormalTok{\} }\CommentTok{#just use this function, custom}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile]{DeclareDesign()}
\protect\hypertarget{declaredesign-3}{}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{answer <-}\StringTok{ }\KeywordTok{declare_estimator}\NormalTok{(}
  \DataTypeTok{handler =} \KeywordTok{tidy_estimator}\NormalTok{(strata_weighted_mean),}
  \DataTypeTok{estimand =}\NormalTok{ my_estimand)}

\NormalTok{design <-}\StringTok{ }\NormalTok{population }\OperatorTok{+}\StringTok{ }\NormalTok{my_estimand }\OperatorTok{+}\StringTok{ }\NormalTok{reporting }\OperatorTok{+}
\StringTok{          }\NormalTok{sampling }\OperatorTok{+}\StringTok{ }\NormalTok{answer}
\NormalTok{diagnosis <-}\StringTok{ }\KeywordTok{diagnose_design}\NormalTok{(design, }\DataTypeTok{sims =} \DecValTok{1000}\NormalTok{)}

\NormalTok{diagnosis}\OperatorTok{$}\NormalTok{diagnosands_df[,}\KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{12}\NormalTok{,}\DecValTok{14}\NormalTok{)] }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{kable}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}rrrr@{}}
\toprule
bias & se(bias) & mean\_estimate & sd\_estimate\tabularnewline
\midrule
\endhead
-0.0012755 & 0.001031 & 0.5423988 & 0.0358173\tabularnewline
\bottomrule
\end{longtable}

\end{frame}

\end{document}
